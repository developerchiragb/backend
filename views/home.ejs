<link rel="stylesheet" href="/css/layout.css">

<section id="feed-posts">
    <%if(locals.user) {%>
    <h2>Posts</h2>
    <form action="/posts/create" method="POST">
        <textarea name="content" cols="30" rows="3" placeholder="Enter the text here...."></textarea>
        <br>
        <button type="submit">Post</button>
    </form>
    <br>
    
    <%}%>
</section>

<div id="posts-list-container">
    <% if(locals.user){ %>
        <% posts.forEach((post)=> { %>
            <p><%= post.content %></p> <!-- note you defined the field as Name not name -->
            <p><%= post.user.name %></p>
            
            <div class="post-comments">
                
                    <form action="/comments/create" method="POST">
                        <input type="text" name="content" placeholder="Type here to add comment....">
                        <input type="hidden" name="post" value="<%=post._id%>">
                        <button type="submit">Add comment</button>
                    </form>
                    
                    

            </div>
            <div class="post-comments-list">
                <ul id="post-comments-<%=post._id%>">
                    <%post.comments.forEach((comment)=>{%>
                        <p><%=comment.user.name%>---><%=comment.content%> </p>
                        
                    <%})%>
                </ul>

            </div>
        <% }) %>
        
        
        
    <% } else{ %>
        
    <% } %>
</div>

 